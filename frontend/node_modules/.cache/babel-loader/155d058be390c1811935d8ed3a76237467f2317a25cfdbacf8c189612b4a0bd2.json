{"ast":null,"code":"import{jwtDecode}from'jwt-decode';import React,{createContext,useContext,useEffect,useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";export const AuthContext=/*#__PURE__*/createContext();export const AuthProvider=_ref=>{let{children}=_ref;const[isRegUser,setIsRegUser]=useState(false);const[user,setUser]=useState(null);useEffect(()=>{const token=localStorage.getItem('token');if(token){try{const decoded=jwtDecode(token);const currentTime=Date.now()/1000;if(decoded.exp<currentTime){// Токен закінчився\nlocalStorage.removeItem('token');setIsRegUser(false);setUser(null);}else{setIsRegUser(true);setUser(decoded);}}catch(error){console.error('Invalid token:',error);localStorage.removeItem('token');setIsRegUser(false);setUser(null);}}else{setIsRegUser(false);setUser(null);}},[]);const logout=()=>{localStorage.removeItem('token');setIsRegUser(false);setUser(null);};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{isRegUser,user,setIsRegUser,setUser,logout},children:children});};export const useAuth=()=>{return useContext(AuthContext);};","map":{"version":3,"names":["jwtDecode","React","createContext","useContext","useEffect","useState","jsx","_jsx","AuthContext","AuthProvider","_ref","children","isRegUser","setIsRegUser","user","setUser","token","localStorage","getItem","decoded","currentTime","Date","now","exp","removeItem","error","console","logout","Provider","value","useAuth"],"sources":["/Users/vasylfalyovskij/Desktop/React-App/frontend/src/context/AuthContext.jsx"],"sourcesContent":["import { jwtDecode } from 'jwt-decode'\nimport React, { createContext, useContext, useEffect, useState } from 'react'\n\nexport const AuthContext = createContext()\n\nexport const AuthProvider = ({ children }) => {\n\tconst [isRegUser, setIsRegUser] = useState(false)\n\tconst [user, setUser] = useState(null)\n\n\tuseEffect(() => {\n\t\tconst token = localStorage.getItem('token')\n\t\tif (token) {\n\t\t\ttry {\n\t\t\t\tconst decoded = jwtDecode(token)\n\t\t\t\tconst currentTime = Date.now() / 1000\n\t\t\t\tif (decoded.exp < currentTime) {\n\t\t\t\t\t// Токен закінчився\n\t\t\t\t\tlocalStorage.removeItem('token')\n\t\t\t\t\tsetIsRegUser(false)\n\t\t\t\t\tsetUser(null)\n\t\t\t\t} else {\n\t\t\t\t\tsetIsRegUser(true)\n\t\t\t\t\tsetUser(decoded)\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('Invalid token:', error)\n\t\t\t\tlocalStorage.removeItem('token')\n\t\t\t\tsetIsRegUser(false)\n\t\t\t\tsetUser(null)\n\t\t\t}\n\t\t} else {\n\t\t\tsetIsRegUser(false)\n\t\t\tsetUser(null)\n\t\t}\n\t}, [])\n\n\tconst logout = () => {\n\t\tlocalStorage.removeItem('token')\n\t\tsetIsRegUser(false)\n\t\tsetUser(null)\n\t}\n\n\treturn (\n\t\t<AuthContext.Provider\n\t\t\tvalue={{ isRegUser, user, setIsRegUser, setUser, logout }}\n\t\t>\n\t\t\t{children}\n\t\t</AuthContext.Provider>\n\t)\n}\n\nexport const useAuth = () => {\n\treturn useContext(AuthContext)\n}\n"],"mappings":"AAAA,OAASA,SAAS,KAAQ,YAAY,CACtC,MAAO,CAAAC,KAAK,EAAIC,aAAa,CAAEC,UAAU,CAAEC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,QAAAC,GAAA,IAAAC,IAAA,yBAE7E,MAAO,MAAM,CAAAC,WAAW,cAAGN,aAAa,CAAC,CAAC,CAE1C,MAAO,MAAM,CAAAO,YAAY,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACxC,KAAM,CAACE,SAAS,CAAEC,YAAY,CAAC,CAAGR,QAAQ,CAAC,KAAK,CAAC,CACjD,KAAM,CAACS,IAAI,CAAEC,OAAO,CAAC,CAAGV,QAAQ,CAAC,IAAI,CAAC,CAEtCD,SAAS,CAAC,IAAM,CACf,KAAM,CAAAY,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,GAAIF,KAAK,CAAE,CACV,GAAI,CACH,KAAM,CAAAG,OAAO,CAAGnB,SAAS,CAACgB,KAAK,CAAC,CAChC,KAAM,CAAAI,WAAW,CAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAG,IAAI,CACrC,GAAIH,OAAO,CAACI,GAAG,CAAGH,WAAW,CAAE,CAC9B;AACAH,YAAY,CAACO,UAAU,CAAC,OAAO,CAAC,CAChCX,YAAY,CAAC,KAAK,CAAC,CACnBE,OAAO,CAAC,IAAI,CAAC,CACd,CAAC,IAAM,CACNF,YAAY,CAAC,IAAI,CAAC,CAClBE,OAAO,CAACI,OAAO,CAAC,CACjB,CACD,CAAE,MAAOM,KAAK,CAAE,CACfC,OAAO,CAACD,KAAK,CAAC,gBAAgB,CAAEA,KAAK,CAAC,CACtCR,YAAY,CAACO,UAAU,CAAC,OAAO,CAAC,CAChCX,YAAY,CAAC,KAAK,CAAC,CACnBE,OAAO,CAAC,IAAI,CAAC,CACd,CACD,CAAC,IAAM,CACNF,YAAY,CAAC,KAAK,CAAC,CACnBE,OAAO,CAAC,IAAI,CAAC,CACd,CACD,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAY,MAAM,CAAGA,CAAA,GAAM,CACpBV,YAAY,CAACO,UAAU,CAAC,OAAO,CAAC,CAChCX,YAAY,CAAC,KAAK,CAAC,CACnBE,OAAO,CAAC,IAAI,CAAC,CACd,CAAC,CAED,mBACCR,IAAA,CAACC,WAAW,CAACoB,QAAQ,EACpBC,KAAK,CAAE,CAAEjB,SAAS,CAAEE,IAAI,CAAED,YAAY,CAAEE,OAAO,CAAEY,MAAO,CAAE,CAAAhB,QAAA,CAEzDA,QAAQ,CACY,CAAC,CAEzB,CAAC,CAED,MAAO,MAAM,CAAAmB,OAAO,CAAGA,CAAA,GAAM,CAC5B,MAAO,CAAA3B,UAAU,CAACK,WAAW,CAAC,CAC/B,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}